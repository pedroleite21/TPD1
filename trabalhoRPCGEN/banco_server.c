/*
 * This is sample code generated by rpcgen.
 * These are only templates and you can use them
 * as a guideline for developing your own functions.
 */

#include "banco.h"
#include <stdio.h>

#define NUM_CONTA 100

conta contas[NUM_CONTA];

int verificaContaBD(int _id) 
{
	for(int i = 0; i < NUM_CONTA; i++) {
		if(contas[i].id == _id)
		{
			return -1;
		}
	}

	return _id;
}

int *
abreconta_1_svc(int *argp, struct svc_req *rqstp)
{
	static int result;
	int id = *argp;

	if(verificaContaBD(id) == -1 || id == 0 || id= == 999) {
		result = -1;
	} else {
		contas[id].id = id;
		contas[id].saldo = 0.0;
		result = id; 
	}

	return &result;
}

int *
fechaconta_1_svc(int *argp, struct svc_req *rqstp)
{
	static int  result;
	int id =  *argp;

	if(verificaContaBD(id) == -1) {
		contas[id].id = 999;
		contas[id].saldo = 999;
		result = 0;
	} else {
		result = -1;
	}

	return &result;
}

int *
authconta_1_svc(int *argp, struct svc_req *rqstp)
{
	static int  result;
	int id = *argp;

	result = verificaContaBD(id);

	return &result;
}

int *
deposito_1_svc(transacao *argp, struct svc_req *rqstp)
{
	static int  result;
	int id = argp->id;
	float valor = argp->saldo;

	result = -1;
	if(verificaContaBD(id) != -1) {
		contas[id].saldo = contas[id].saldo + valor;
		result = 0;
	}

	return &result;
}

int *
saque_1_svc(transacao *argp, struct svc_req *rqstp)
{
	static int  result;
	int id = argp->id;
	int valor = argp->saldo;

	result = -1;
	if(verificaContaBD(id) != -1) {
		contas[id].saldo = contas[id].saldo - valor;
		result = 0;
	}

	return &result;
}

float *
retornasaldo_1_svc(int *argp, struct svc_req *rqstp)
{
	static float  result;
	int id = *argp;

	result = -1.0;
	if(verifica_conta(id) != -1) {
		result = contas[id].saldo; 
	}

	return &result;
}

int *
checksenha_1_svc(token *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}

int *
gerasenha_1_svc(token *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}

int *
falhasenha_1_svc(token *argp, struct svc_req *rqstp)
{
	static int  result;

	/*
	 * insert server code here
	 */

	return &result;
}
